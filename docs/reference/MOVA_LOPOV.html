<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The Random forest analysis with 'distance to the known pathogenic variant', ΔBLOSUM62,pLDDT as explanatory variables and the pathogenicity of the variant as objective variable.
  The study was trained with 11 genes, one out of 12 ALS-related genes (TARDBP, FUS, SETX, TBK1, OPTN, SOD1, VCP, SQSTM1, ANG, UBQLN2, DCTN1, CCNF), and validated with the remaining one gene. The process was repeated with different validation genes to ensure that all genes were validated.
MOVA_predistance function must be performed before this function.
"><title>do a leave one protein out validation (using 11 proteins' variations for training, 1 protein's for testing)
 — MOVA_LOPOV • MOVA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="do a leave one protein out validation (using 11 proteins' variations for training, 1 protein's for testing)
 — MOVA_LOPOV"><meta property="og:description" content="The Random forest analysis with 'distance to the known pathogenic variant', ΔBLOSUM62,pLDDT as explanatory variables and the pathogenicity of the variant as objective variable.
  The study was trained with 11 genes, one out of 12 ALS-related genes (TARDBP, FUS, SETX, TBK1, OPTN, SOD1, VCP, SQSTM1, ANG, UBQLN2, DCTN1, CCNF), and validated with the remaining one gene. The process was repeated with different validation genes to ensure that all genes were validated.
MOVA_predistance function must be performed before this function.
"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MOVA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>do a leave one protein out validation (using 11 proteins' variations for training, 1 protein's for testing)
<!-- %%  ~~function to do ... ~~ --></h1>
      
      <div class="d-none name"><code>MOVA_LOPOV.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The Random forest analysis with 'distance to the known pathogenic variant', ΔBLOSUM62,pLDDT as explanatory variables and the pathogenicity of the variant as objective variable.
  The study was trained with 11 genes, one out of 12 ALS-related genes (TARDBP, FUS, SETX, TBK1, OPTN, SOD1, VCP, SQSTM1, ANG, UBQLN2, DCTN1, CCNF), and validated with the remaining one gene. The process was repeated with different validation genes to ensure that all genes were validated.
MOVA_predistance function must be performed before this function.
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MOVA_LOPOV</span><span class="op">(</span>phenotype <span class="op">=</span> <span class="st">"Target"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>phenotype</dt>
<dd><p>Specify "Target" if you want the positive variant to be the Target variant only, or "Pathogenic" if you want to include the Pathogenic variant as well. The default is "Target".
<!-- %%     ~~Describe \code{phenotype} here~~ --></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To perform this function, MOVA fuction must be performed on all genes in TARDBP, FUS, SETX, TBK1, OPTN, SOD1, VCP, SQSTM1, ANG, UBQLN2, DCTN1, CCNF. MOVA_LOPOV is a random forest analysis with 'distance to the known pathogenic variant', ΔBLOSUM62, pLDDT as explanatory variables and the pathogenicity of the variant as objective variable. MOVA_LOPOV is evaluated using the leave one protein out validation. The MOVA_LOPOV predicted value are added to the "MOVA_LOPOV_predict" column in "LOPOV_Target or Pathogenic_finalpredict.csv". "LOPOV_Target or Pathogenic_result.csv" contains the Cutoff value (Youden index) for each gene (Column: Cutoff), the number of positive variants for each gene used in the analysis (Column: positive_variant_num), number of negative variants (Column: negative_variant_num), AUC for each gene of MOVA_LOPOV (Column: AUC), cvAUC for MOVA_LOPOV (Column: cvauc). The file required for redrawing with the redraw function of MOVA_LOPOV is output in "LOPOV_Target or Pathogenic_predict_orig.csv".
<!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data.frame containing the Cutoff value (Youden index) for each gene (Column: Cutoff), the number of positive variants for each gene used in the analysis (Column: positive_variant_num), number of negative variants (Column: negative_variant_num), AUC for each gene of MOVA_LOPOV (Column: AUC), cvAUC for MOVA_LOPOV (Column: cvauc).
The same data is output to "LOPOV_Target or Pathogenic_result.csv".
<!-- %%  ~Describe the value returned --></p>


<p><!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><!-- %% ~put references to the literature/web site here ~ --></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yuya Hatano
<!-- %%  ~~who you are~~ --></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><!-- %%  ~~further notes~~ --></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ --></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">MOVA_LOPOV</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in fread(paste(read_name[1], phenotype, "predict.csv", sep = "_")):</span> File 'TARDBP_Target_predict.csv' does not exist or is non-readable. getwd()=='D:/ALS/R/new_variant_prediction/revise_package/MOVA/docs/reference'</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The function is currently defined as</span></span></span>
<span class="r-in"><span><span class="kw">function</span> <span class="op">(</span><span class="va">phenotype</span> <span class="op">=</span> <span class="st">"Target"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">read_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TARDBP"</span>, <span class="st">"FUS"</span>, <span class="st">"SETX"</span>, <span class="st">"TBK1"</span>, <span class="st">"OPTN"</span>, <span class="st">"SOD1"</span>, </span></span>
<span class="r-in"><span>        <span class="st">"VCP"</span>, <span class="st">"SQSTM1"</span>, <span class="st">"ANG"</span>, <span class="st">"UBQLN2"</span>, <span class="st">"DCTN1"</span>, <span class="st">"CCNF"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">read_name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">phenotype</span>, <span class="st">"predict.csv"</span>, </span></span>
<span class="r-in"><span>        sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">final_data</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">read_name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">phenotype</span>, <span class="st">"finalpredict.csv"</span>, </span></span>
<span class="r-in"><span>        sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">D</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="va">read_name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">D</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">D</span><span class="op">$</span><span class="va">glm_CaddDeogenRevel</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="va">D</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">glm_CaddDeogenRevel</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">final_data</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="va">read_name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">final_data</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">final_data</span><span class="op">$</span><span class="va">glm_CaddDeogenRevel</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="va">final_data</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">glm_CaddDeogenRevel</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">D</span><span class="op">$</span><span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="va">phenotype</span> <span class="op">==</span> <span class="st">"Target"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">D</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">$</span><span class="va">Type2</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">D</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">$</span><span class="va">Type3</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">D</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">x</span></span></span>
<span class="r-in"><span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">D</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">D</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i3</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> </span></span>
<span class="r-in"><span>            <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">z</span> <span class="op">-</span> <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">z</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">z</span> <span class="op">-</span> <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">t_distance</span>, decreasing <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="kw">if</span> <span class="op">(</span><span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="va">t_distance</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">D</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="va">t_distance</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">read_name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">phenotype</span>, <span class="st">"predict.csv"</span>, </span></span>
<span class="r-in"><span>            sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">final_data2</span> <span class="op">&lt;-</span> <span class="fu">fread</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">read_name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">phenotype</span>, <span class="st">"finalpredict.csv"</span>, </span></span>
<span class="r-in"><span>            sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">df2</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="va">read_name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">df2</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">&lt;-</span> <span class="va">i</span></span></span>
<span class="r-in"><span>        <span class="va">df2</span><span class="op">$</span><span class="va">glm_CaddDeogenRevel</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>        <span class="va">df2</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">glm_CaddDeogenRevel</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="kw">if</span> <span class="op">(</span><span class="va">phenotype</span> <span class="op">==</span> <span class="st">"Target"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">df2</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">$</span><span class="va">Type2</span></span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">df2</span><span class="op">$</span><span class="va">result</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">$</span><span class="va">Type3</span></span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="va">df2</span><span class="op">$</span><span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">[</span><span class="va">df2</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">x</span></span></span>
<span class="r-in"><span>        <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">[</span><span class="va">df2</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span>        <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">[</span><span class="va">df2</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">z</span></span></span>
<span class="r-in"><span>        <span class="kw">for</span> <span class="op">(</span><span class="va">i3</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>            <span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">z</span> <span class="op">-</span> <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">z</span><span class="op">)</span> <span class="op">*</span> </span></span>
<span class="r-in"><span>                <span class="op">(</span><span class="va">z</span> <span class="op">-</span> <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">z</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">t_distance</span>, decreasing <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></span>
<span class="r-in"><span>            <span class="kw">if</span> <span class="op">(</span><span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="va">t_distance</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>            <span class="op">}</span></span></span>
<span class="r-in"><span>            <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                <span class="va">df2</span><span class="op">[</span><span class="va">i3</span><span class="op">]</span><span class="op">$</span><span class="va">t_distance</span> <span class="op">&lt;-</span> <span class="va">t_distance</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>            <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="op">}</span></span></span>
<span class="r-in"><span>        <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">D</span>, <span class="va">df2</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">final_data2</span><span class="op">$</span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="va">read_name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">final_data2</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">&lt;-</span> <span class="va">i</span></span></span>
<span class="r-in"><span>        <span class="va">final_data2</span><span class="op">$</span><span class="va">glm_CaddDeogenRevel</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>        <span class="va">final_data2</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">glm_CaddDeogenRevel</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">final_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">final_data</span>, <span class="va">final_data2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        <span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"result"</span>, <span class="st">"predict"</span>, <span class="st">"change"</span>, <span class="st">"gene_number"</span>, </span></span>
<span class="r-in"><span>        <span class="st">"gene"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">fpredict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        <span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fpredict</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"change"</span>, <span class="st">"predict"</span>, <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">imp.rfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        <span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">imp.rfa</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"IncNodePurity"</span>, <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">oldw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"warn"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>warn <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">val</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">D</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">train.data</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">D</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">!=</span> <span class="va">i</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="op">(</span><span class="va">result</span> <span class="op">~</span> <span class="va">con</span> <span class="op">+</span> <span class="va">t_distance</span> <span class="op">+</span> <span class="va">b</span>, <span class="va">train.data</span>, </span></span>
<span class="r-in"><span>            importance <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">imp.rf</span> <span class="op">&lt;-</span> <span class="fu">importance</span><span class="op">(</span><span class="va">rf</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">ID</span>, result <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">result</span>, predict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf</span>, </span></span>
<span class="r-in"><span>            <span class="va">val</span><span class="op">)</span>, change <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">change</span>, gene_number <span class="op">=</span> <span class="va">i</span>, gene <span class="op">=</span> <span class="va">val</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">final_data</span><span class="op">[</span><span class="va">final_data</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> </span></span>
<span class="r-in"><span>            <span class="va">i</span>, <span class="op">]</span><span class="op">$</span><span class="va">ID</span>, MOVA_LOPOV_predict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf</span>, <span class="va">final_data</span><span class="op">[</span><span class="va">final_data</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> </span></span>
<span class="r-in"><span>            <span class="va">i</span>, <span class="op">]</span><span class="op">)</span>, gene_number <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">fpredict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fpredict</span>, <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">imp.rf</span><span class="op">)</span>, IncNodePurity <span class="op">=</span> <span class="va">imp.rf</span>, </span></span>
<span class="r-in"><span>            n <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">imp.rfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">imp.rfa</span>, <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>warn <span class="op">=</span> <span class="va">oldw</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">fpredictb</span> <span class="op">&lt;-</span> <span class="va">fpredict</span></span></span>
<span class="r-in"><span>    <span class="va">imp.rfb</span> <span class="op">&lt;-</span> <span class="va">imp.rfa</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>IncMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">IncNodePurity..IncMSE</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        IncNodePurity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">IncNodePurity.IncNodePurity</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">final_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">fpredictb</span>, <span class="va">final_data</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">fwrite</span><span class="op">(</span><span class="va">final_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"LOPOV"</span>, <span class="va">phenotype</span>, <span class="st">"finalpredict.csv"</span>, </span></span>
<span class="r-in"><span>        sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">fwrite</span><span class="op">(</span><span class="va">imp.rfb</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"LOPOV"</span>, <span class="va">phenotype</span>, <span class="st">"importance.csv"</span>, </span></span>
<span class="r-in"><span>        sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">cvAUC</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">predict</span>, <span class="va">df</span><span class="op">$</span><span class="va">result</span>, label.ordering <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>        folds <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">gene_number</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">perf</span>, col <span class="op">=</span> <span class="st">"red"</span>, avg <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cvauc</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">cvAUC</span></span></span>
<span class="r-in"><span>    <span class="va">YI2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        <span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">YI2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cutoff"</span>, <span class="st">"positive_variant_num"</span>, <span class="st">"negative_variant_num"</span>, </span></span>
<span class="r-in"><span>        <span class="st">"AUC"</span>, <span class="st">"cvauc"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">prediction</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span><span class="op">$</span><span class="va">predict</span>, </span></span>
<span class="r-in"><span>            <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span><span class="op">$</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">auc.tmp</span> <span class="op">&lt;-</span> <span class="fu">performance</span><span class="op">(</span><span class="va">pred</span>, <span class="st">"auc"</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">auc.tmp</span><span class="op">@</span><span class="va">y.values</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Cutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">cutoffs</span><span class="op">)</span>, TP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tp</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            FP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">fp</span><span class="op">)</span>, FN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">fn</span><span class="op">)</span>, TN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tn</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            Sensitivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tp</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tp</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">fn</span><span class="op">)</span><span class="op">)</span>, Specificity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tn</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">fp</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tn</span><span class="op">)</span><span class="op">)</span>, Accuracy <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tp</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tn</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, Precision <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tp</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">tp</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">pred</span><span class="op">@</span><span class="va">fp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">tab</span><span class="op">$</span><span class="va">Youden</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">$</span><span class="va">Sensitivity</span> <span class="op">+</span> <span class="va">tab</span><span class="op">$</span><span class="va">Specificity</span> <span class="op">-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>        <span class="va">YI</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tab</span><span class="op">$</span><span class="va">Youden</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="va">YI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Cutoff <span class="op">=</span> <span class="va">YI</span><span class="op">$</span><span class="va">Cutoff</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, positive_variant_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> </span></span>
<span class="r-in"><span>            <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>, negative_variant_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">result</span> <span class="op">==</span> </span></span>
<span class="r-in"><span>            <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">gene_number</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>, AUC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">auc</span><span class="op">)</span>, cvauc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cvauc</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">read_name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="va">YI2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">YI2</span>, <span class="va">YI</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="fu">fwrite</span><span class="op">(</span><span class="va">YI2</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"LOPOV"</span>, <span class="va">phenotype</span>, <span class="st">"result.csv"</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>MOVA_LOPOV_predict <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">predict</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">fwrite</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">D</span>, <span class="va">df2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"LOPOV"</span>, <span class="va">phenotype</span>, <span class="st">"predict.csv"</span>, </span></span>
<span class="r-in"><span>        sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">fwrite</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"LOPOV"</span>, <span class="va">phenotype</span>, <span class="st">"predict_orig.csv"</span>, </span></span>
<span class="r-in"><span>        sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">YI2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (phenotype = "Target") </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     read_name &lt;- c("TARDBP", "FUS", "SETX", "TBK1", "OPTN", "SOD1", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "VCP", "SQSTM1", "ANG", "UBQLN2", "DCTN1", "CCNF")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D &lt;- fread(paste(read_name[1], phenotype, "predict.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     final_data &lt;- fread(paste(read_name[1], phenotype, "finalpredict.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D$gene &lt;- read_name[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D$gene_number &lt;- 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D$glm_CaddDeogenRevel &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D[, `:=`(glm_CaddDeogenRevel, NULL)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     final_data$gene &lt;- read_name[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     final_data$gene_number &lt;- 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     final_data$glm_CaddDeogenRevel &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     final_data[, `:=`(glm_CaddDeogenRevel, NULL)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     D$t_distance &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (phenotype == "Target") {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         D$result &lt;- D$Type2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         D$result &lt;- D$Type3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     x &lt;- D[D$result == 1, ]$x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     y &lt;- D[D$result == 1, ]$y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     z &lt;- D[D$result == 1, ]$z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     for (i3 in 1:nrow(D)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         t_distance &lt;- sqrt((x - D[i3]$x) * (x - D[i3]$x) + (y - </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             D[i3]$y) * (y - D[i3]$y) + (z - D[i3]$z) * (z - D[i3]$z))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         t_distance &lt;- sort(t_distance, decreasing = F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (D[i3]$result == 1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             D[i3]$t_distance &lt;- t_distance[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             D[i3]$t_distance &lt;- t_distance[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     for (i in 2:12) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df2 &lt;- fread(paste(read_name[i], phenotype, "predict.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         final_data2 &lt;- fread(paste(read_name[i], phenotype, "finalpredict.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df2$gene &lt;- read_name[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df2$gene_number &lt;- i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df2$glm_CaddDeogenRevel &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df2[, `:=`(glm_CaddDeogenRevel, NULL)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         if (phenotype == "Target") {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             df2$result &lt;- df2$Type2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             df2$result &lt;- df2$Type3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df2$t_distance &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         x &lt;- df2[df2$result == 1, ]$x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         y &lt;- df2[df2$result == 1, ]$y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         z &lt;- df2[df2$result == 1, ]$z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         for (i3 in 1:nrow(df2)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t_distance &lt;- sqrt((x - df2[i3]$x) * (x - df2[i3]$x) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 (y - df2[i3]$y) * (y - df2[i3]$y) + (z - df2[i3]$z) * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 (z - df2[i3]$z))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             t_distance &lt;- sort(t_distance, decreasing = F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             if (df2[i3]$result == 1) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 df2[i3]$t_distance &lt;- t_distance[2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             else {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 df2[i3]$t_distance &lt;- t_distance[1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         D &lt;- rbind(D, df2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         final_data2$gene &lt;- read_name[i]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         final_data2$gene_number &lt;- i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         final_data2$glm_CaddDeogenRevel &lt;- 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         final_data2[, `:=`(glm_CaddDeogenRevel, NULL)]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         final_data &lt;- rbind(final_data, final_data2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     df &lt;- data.frame(matrix(rep(NA, 6), nrow = 1))[numeric(0), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(df) &lt;- c("ID", "result", "predict", "change", "gene_number", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "gene")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fpredict &lt;- data.frame(matrix(rep(NA, 3), nrow = 1))[numeric(0), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(fpredict) &lt;- c("change", "predict", "n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     imp.rfa &lt;- data.frame(matrix(rep(NA, 3), nrow = 1))[numeric(0), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(imp.rfa) &lt;- c("name", "IncNodePurity", "n")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     oldw &lt;- getOption("warn")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     options(warn = -1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     for (i in 1:12) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         val &lt;- D[D$gene_number == i, ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         train.data &lt;- D[D$gene_number != i, ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rf &lt;- randomForest(result ~ con + t_distance + b, train.data, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             importance = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         imp.rf &lt;- importance(rf)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         f &lt;- data.frame(ID = val$ID, result = val$result, predict = predict(rf, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             val), change = val$change, gene_number = i, gene = val$gene)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df &lt;- rbind(df, f)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         f &lt;- data.frame(ID = final_data[final_data$gene_number == </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             i, ]$ID, MOVA_LOPOV_predict = predict(rf, final_data[final_data$gene_number == </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             i, ]), gene_number = i)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         fpredict &lt;- rbind(fpredict, f)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         f &lt;- data.frame(name = rownames(imp.rf), IncNodePurity = imp.rf, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             n = i)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         imp.rfa &lt;- rbind(imp.rfa, f)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     options(warn = oldw)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fpredictb &lt;- fpredict</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     imp.rfb &lt;- imp.rfa %&gt;% group_by(name) %&gt;% summarise(IncMSE = mean(IncNodePurity..IncMSE), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         IncNodePurity = mean(IncNodePurity.IncNodePurity))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     final_data &lt;- merge(fpredictb, final_data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fwrite(final_data, paste("LOPOV", phenotype, "finalpredict.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fwrite(imp.rfb, paste("LOPOV", phenotype, "importance.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     out &lt;- cvAUC(df$predict, df$result, label.ordering = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         folds = df$gene_number)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     plot(out$perf, col = "red", avg = "vertical")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cvauc &lt;- out$cvAUC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     YI2 &lt;- data.frame(matrix(rep(NA, 5), nrow = 1))[numeric(0), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     colnames(YI2) &lt;- c("Cutoff", "positive_variant_num", "negative_variant_num", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         "AUC", "cvauc")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     for (i in 1:12) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         pred &lt;- prediction(df[df$gene_number == i, ]$predict, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             df[df$gene_number == i, ]$result)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         auc.tmp &lt;- performance(pred, "auc")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         auc &lt;- as.numeric(auc.tmp@y.values)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tab &lt;- data.frame(Cutoff = unlist(pred@cutoffs), TP = unlist(pred@tp), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             FP = unlist(pred@fp), FN = unlist(pred@fn), TN = unlist(pred@tn), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Sensitivity = unlist(pred@tp)/(unlist(pred@tp) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 unlist(pred@fn)), Specificity = unlist(pred@tn)/(unlist(pred@fp) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 unlist(pred@tn)), Accuracy = ((unlist(pred@tp) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 unlist(pred@tn))/nrow(df)), Precision = (unlist(pred@tp)/(unlist(pred@tp) + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 unlist(pred@fp))))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tab$Youden &lt;- tab$Sensitivity + tab$Specificity - 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YI &lt;- tab[order(tab$Youden, decreasing = T), ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YI &lt;- data.frame(Cutoff = YI$Cutoff[1], positive_variant_num = c(nrow(df[(df$result == </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             1) &amp; (df$gene_number == 1), ])), negative_variant_num = c(nrow(df[(df$result == </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             0) &amp; (df$gene_number == 1), ])), AUC = c(auc), cvauc = c(cvauc), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             gene = c(read_name[i]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YI2 &lt;- rbind(YI2, YI)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fwrite(YI2, paste("LOPOV", phenotype, "result.csv", sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     df2 &lt;- df %&gt;% group_by(ID) %&gt;% summarise(MOVA_LOPOV_predict = mean(predict))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fwrite(merge(D, df2), paste("LOPOV", phenotype, "predict.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     fwrite(df, paste("LOPOV", phenotype, "predict_orig.csv", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sep = "_"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(YI2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x0000011a80e6fa68&gt;</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yuya Hatano.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

